<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="ja"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;メインコピー生成&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSSを読み込みます --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Interフォントを読み込みます */</p>
<p class="p1"><span class="Apple-converted-space">        </span>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap');</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>scroll-behavior: smooth;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* ローディングスピナーのアニメーション */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.loader {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 4px solid #f3f3f3;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-top: 4px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 40px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 40px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>animation: spin 1s linear infinite;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>@keyframes spin {</p>
<p class="p1"><span class="Apple-converted-space">            </span>0% { transform: rotate(0deg); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>100% { transform: rotate(360deg); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-gray-100 flex items-center justify-center min-h-screen py-8"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container mx-auto p-4 md:p-8 max-w-3xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white rounded-2xl shadow-lg p-6 md:p-10"&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;header class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2"&gt;AIメインコピー生成アプリ&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p class="text-gray-500"&gt;ウェブページのURLを入力すると、AIが内容を分析して魅力的なメインコピーを提案します。&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;main&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- URL入力フォーム --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="space-y-4 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="urlInput" class="block text-sm font-medium text-gray-700 mb-1"&gt;ウェブサイトURL&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="url" id="urlInput" placeholder="https://example.com" class="w-full px-4 py-3 bg-gray-50 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;!-- 追加の要望入力フォーム --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="additionalRequestInput" class="block text-sm font-medium text-gray-700 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>追加の要望 (任意)</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="text-xs text-gray-500 ml-1"&gt;例: 若者向け、面白い感じで、SEOを意識して&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;textarea id="additionalRequestInput" rows="2" placeholder="コピーのテイストやターゲットなどを入力" class="w-full px-4 py-3 bg-gray-50 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="generateButton" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>提案を生成</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- 結果表示エリア --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="resultContainer" class="mt-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- ローディング表示 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="loader" class="hidden flex flex-col items-center justify-center text-center p-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="loader mb-4"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-600 font-semibold"&gt;AIがページを読み込んで分析中です...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-500"&gt;少し時間がかかる場合があります。&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- エラーメッセージ表示 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="errorMessage" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative" role="alert"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;strong class="font-bold"&gt;エラーが発生しました。&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="block sm:inline" id="errorText"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- 手動入力のフォールバックエリア --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="manualInputContainer" class="hidden mt-6 p-6 bg-gray-50 rounded-lg border border-dashed"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-lg font-semibold text-gray-800 mb-2"&gt;URLの読み込みに失敗しました&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-600 mb-4"&gt;お手数ですが、ウェブサイトのテキストを以下に直接貼り付けて生成してください。&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;textarea id="manualTextInput" rows="10" class="w-full px-4 py-3 bg-white border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="ここにウェブサイトの本文を貼り付け..."&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="generateFromTextButton" class="mt-4 w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>このテキストから提案を生成</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- 生成されたコピー表示 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="copyResult" class="hidden mt-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;h2 class="text-2xl font-bold text-gray-800 mb-4 border-b-2 pb-2"&gt;提案されたメインコピー&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div id="copyList" class="grid grid-cols-1 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- ここに結果カードが挿入されます --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/main&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;footer class="text-center mt-6 text-gray-500 text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;&amp;copy; 2024 コーディング パートナー&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/footer&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// DOM要素を取得</p>
<p class="p1"><span class="Apple-converted-space">        </span>const urlInput = document.getElementById('urlInput');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const additionalRequestInput = document.getElementById('additionalRequestInput');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const generateButton = document.getElementById('generateButton');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const loader = document.getElementById('loader');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const errorMessage = document.getElementById('errorMessage');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const errorText = document.getElementById('errorText');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const copyResult = document.getElementById('copyResult');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const copyList = document.getElementById('copyList');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const manualInputContainer = document.getElementById('manualInputContainer');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const manualTextInput = document.getElementById('manualTextInput');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const generateFromTextButton = document.getElementById('generateFromTextButton');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// イベントリスナーを設定</p>
<p class="p1"><span class="Apple-converted-space">        </span>generateButton.addEventListener('click', handleGeneration);</p>
<p class="p1"><span class="Apple-converted-space">        </span>generateFromTextButton.addEventListener('click', handleGenerationFromText);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function handleGeneration() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const url = urlInput.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!url) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('URLを入力してください。');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>resetUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>setLoadingState(true);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// CORSプロキシ経由でウェブページのHTMLを取得</p>
<p class="p1"><span class="Apple-converted-space">                </span>const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const response = await fetch(proxyUrl);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!response.ok) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>throw new Error(`ページの取得に失敗しました (ステータス: ${response.status})`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>const htmlContent = await response.text();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const parser = new DOMParser();</p>
<p class="p1"><span class="Apple-converted-space">                </span>const doc = parser.parseFromString(htmlContent, 'text/html');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const bodyText = doc.body.innerText || "";</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (bodyText.trim().length &lt; 50) {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>throw new Error('ページから十分なテキストを抽出できませんでした。別のURLを試してください。');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>await generateCopy(bodyText);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('URLからの生成エラー:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const userMessage = 'ページの自動取得に失敗しました。サイトが外部アクセスをブロックしているか、URLが正しくない可能性があります。';</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError(userMessage);</p>
<p class="p1"><span class="Apple-converted-space">                </span>manualInputContainer.classList.remove('hidden'); // フォールバックを表示</p>
<p class="p1"><span class="Apple-converted-space">            </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">                </span>setLoadingState(false);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function handleGenerationFromText() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const textContent = manualTextInput.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!textContent) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('テキストエリアに内容を貼り付けてください。');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>resetUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>setLoadingState(true);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>await generateCopy(textContent);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>setLoadingState(false);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateCopy(textContent) {</p>
<p class="p1"><span class="Apple-converted-space">             </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const truncatedText = textContent.substring(0, 4000);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const additionalRequest = additionalRequestInput.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">                </span>const generatedCopyText = await callGeminiAPI(truncatedText, additionalRequest);</p>
<p class="p1"><span class="Apple-converted-space">                </span>displayResults(generatedCopyText);</p>
<p class="p1"><span class="Apple-converted-space">             </span>} catch(apiError) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('API呼び出しエラー:', apiError);</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError(apiError.message || 'AIからの応答がありませんでした。');</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function callGeminiAPI(textContent, additionalRequest) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const apiKey = "";<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let prompt = `以下のウェブサイトのコンテンツを分析し、ユーザーの興味を引く魅力的なメインコピーを日本語で10個提案してください。</p>
<p class="p1">以下のルールを厳守してください:</p>
<p class="p1">- 箇条書きで、提案するコピーのみをリストアップすること。</p>
<p class="p1">- 説明文や前置き、結びの言葉は一切含めないこと。</p>
<p class="p1">- 「」や他の記号は一切使用しないこと。`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (additionalRequest) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>prompt = `以下のウェブサイトのコンテンツと【追加の要望】を基に、ユーザーの興味を引く魅力的なメインコピーを日本語で10個提案してください。</p>
<p class="p1">以下のルールを厳守してください:</p>
<p class="p1">- 箇条書きで、提案するコピーのみをリストアップすること。</p>
<p class="p1">- 説明文や前置き、結びの言葉は一切含めないこと。</p>
<p class="p1">- 「」や他の記号は一切使用しないこと。</p>
<p class="p1">\n\n【追加の要望】\n${additionalRequest}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>prompt += `\n\n---\n[ウェブサイトのコンテンツ]\n${textContent}\n---\n\n提案:`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const payload = { contents: [{ parts: [{ text: prompt }] }] };</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const response = await fetch(apiUrl, {</p>
<p class="p1"><span class="Apple-converted-space">                </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">                </span>headers: { 'Content-Type': 'application/json' },</p>
<p class="p1"><span class="Apple-converted-space">                </span>body: JSON.stringify(payload)</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!response.ok) throw new Error('AIとの通信に失敗しました。');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await response.json();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result.candidates?.[0]?.content?.parts?.[0]?.text) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>return result.candidates[0].content.parts[0].text;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>throw new Error('AIが有効な提案を生成できませんでした。');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function setLoadingState(isLoading) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isLoading) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>loader.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>generateButton.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>generateButton.textContent = '生成中...';</p>
<p class="p1"><span class="Apple-converted-space">                </span>generateFromTextButton.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>loader.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>generateButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>generateButton.textContent = '提案を生成';</p>
<p class="p1"><span class="Apple-converted-space">                </span>generateFromTextButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function resetUI() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>errorMessage.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>copyResult.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>manualInputContainer.classList.add('hidden');<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>copyList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showError(message) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>errorText.textContent = message;</p>
<p class="p1"><span class="Apple-converted-space">            </span>errorMessage.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function displayResults(text) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>copyList.innerHTML = ''; // 古い結果をクリア</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lines = text.split('\n').filter(line =&gt; line.trim().length &gt; 0);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>lines.forEach(line =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// 箇条書きのマーカー、引用符、その他の不要な装飾を削除</p>
<p class="p1"><span class="Apple-converted-space">                </span>const cleanText = line.replace(/^[\s*-\d.]+\s*/, '').replace(/「|」/g, '').trim();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// クリーンなテキストが空でなければカードを作成</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (cleanText) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const card = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>card.className = 'bg-slate-50 p-4 rounded-lg border border-gray-200 flex flex-col sm:flex-row justify-between sm:items-center gap-4 transition-shadow hover:shadow-md';</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const textToCopy = cleanText;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const displayText = cleanText;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>card.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-800 flex-grow text-lg"&gt;${displayText}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="copy-button flex-shrink-0 w-full sm:w-auto bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-all duration-200 ease-in-out"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"&gt;&lt;path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/&gt;&lt;path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span&gt;コピー&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>card.querySelector('.copy-button').addEventListener('click', (e) =&gt; copyToClipboard(textToCopy, e.currentTarget));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>copyList.appendChild(card);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>copyResult.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function copyToClipboard(text, buttonElement) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const textArea = document.createElement("textarea");</p>
<p class="p1"><span class="Apple-converted-space">            </span>textArea.value = text;</p>
<p class="p1"><span class="Apple-converted-space">            </span>textArea.style.position = "fixed"; textArea.style.top = 0; textArea.style.left = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.body.appendChild(textArea);</p>
<p class="p1"><span class="Apple-converted-space">            </span>textArea.select();</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.execCommand('copy');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const originalContent = buttonElement.innerHTML;</p>
<p class="p1"><span class="Apple-converted-space">                </span>buttonElement.innerHTML = `&lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-lg" viewBox="0 0 16 16"&gt;&lt;path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022z"/&gt;&lt;/svg&gt; &lt;span&gt;コピーしました！&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>buttonElement.classList.replace('bg-gray-200', 'bg-green-500');</p>
<p class="p1"><span class="Apple-converted-space">                </span>buttonElement.classList.add('text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>buttonElement.innerHTML = originalContent;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>buttonElement.classList.replace('bg-green-500', 'bg-gray-200');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>buttonElement.classList.remove('text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 2000);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (err) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('クリップボードへのコピーに失敗しました', err);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.body.removeChild(textArea);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
